---
description: コンフリクト解決支援
allowed-tools: Bash(git:*), Read, Edit
model: opus
---

# コンフリクト解決支援

マージコンフリクトの状況を分析し、解決を支援します。

## 実行手順

### 1. コンフリクト状況の確認

```bash
# コンフリクトファイル一覧
git diff --name-only --diff-filter=U

# マージ状態確認
git status --porcelain | grep "^UU\|^AA\|^DD"
```

コンフリクトがない場合はその旨を通知して終了。

### 2. コンフリクト詳細の表示

各コンフリクトファイルについて:

```bash
# ファイルごとのコンフリクト箇所を表示
git diff <file>
```

以下の形式で表示:

```
## コンフリクトファイル一覧

1. `path/to/file1.py` - N箇所のコンフリクト
2. `path/to/file2.js` - M箇所のコンフリクト

## 詳細

### path/to/file1.py

```diff
<<<<<<< HEAD (現在のブランチ)
// 現在のコード
=======
// マージ元のコード
>>>>>>> branch-name
```

**推奨**: [どちらを採用すべきか、または両方を統合する方法]
```

### 3. 解決ガイド

コンフリクトの種類に応じたガイドを提示:

| 種類 | 説明 | 推奨対応 |
|------|------|---------|
| 同一行の変更 | 両ブランチで同じ行を変更 | 手動で統合 |
| ファイル削除と変更 | 片方が削除、片方が変更 | どちらを採用するか判断 |
| 両方で追加 | 両ブランチで同じ位置に追加 | 両方を残すか選択 |

### 4. 解決支援

ユーザーの選択に基づいて解決を支援:

1. **自動解決可能な場合**: Editツールで修正を提案
2. **手動解決が必要な場合**: 具体的な手順を案内

```bash
# 解決後のマーク
git add <resolved-file>

# すべて解決後
git commit
```

### 5. 解決後の確認

```bash
# 残りのコンフリクト確認
git diff --name-only --diff-filter=U

# マージ状態
git status
```

## 使用例

```
/resolve-conflicts
```

→ 現在のコンフリクト状況を分析し、解決を支援

## 注意事項

- コンフリクト解決は慎重に行う
- 不明な場合は両方の変更を保持する方向で提案
- 重要なロジックの変更は人間の判断を仰ぐ
